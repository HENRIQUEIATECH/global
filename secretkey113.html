<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HPS | SecretKey-Protocol</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=Roboto+Mono:wght@400;700&display=swap');
        
        body {
            background: radial-gradient(circle at center, #F0F4F2 0%, #E2E8E5 100%);
            color: #2D3436; font-family: 'Inter', sans-serif;
            min-height: 100vh; display: flex; align-items: center; justify-content: center; padding: 20px;
        }

        .node-card {
            background: white; border-radius: 32px; position: relative; padding: 3px;
            overflow: hidden; transition: all 0.5s ease; opacity: 0.1; pointer-events: none;
        }
        .node-active { opacity: 1; pointer-events: auto; }

        .node-card::before {
            content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%;
            background: conic-gradient(transparent, transparent, #D4AF37, transparent);
            animation: rotateGold 4s linear infinite; z-index: 1;
        }
        .node-card.completed::before { background: conic-gradient(transparent, transparent, #22C55E, transparent); }

        @keyframes rotateGold { 100% { transform: rotate(360deg); } }

        .card-inner {
            background: #ffffff; border-radius: 30px; padding: 30px;
            position: relative; z-index: 2; height: 100%; display: flex; flex-direction: column; align-items: center;
        }

        .enter-btn {
            background: #1A1A1A; color: white; border-radius: 8px;
            padding: 8px 16px; font-size: 10px; font-weight: bold;
            margin-top: 12px; transition: all 0.3s; opacity: 0; transform: translateY(10px);
        }
        .btn-show { opacity: 1; transform: translateY(0); }

        .gold-button {
            background: linear-gradient(135deg, #D4AF37 0%, #B8860B 100%);
            color: white; opacity: 0.1; pointer-events: none;
        }
        .btn-ready { opacity: 1; pointer-events: auto; transform: scale(1.05); }

        #loader { display: none; width: 100%; height: 4px; background: #eee; position: fixed; top: 0; left: 0; z-index: 200; }
        #loader-bar { width: 0%; height: 100%; background: #D4AF37; transition: width 0.5s; }
    </style>
</head>
<body>

    <div id="loader"><div id="loader-bar"></div></div>

    <div class="max-w-6xl w-full">
        <div class="text-center mb-10">
            <h1 class="text-3xl font-mono font-bold text-[#1A1A1A] tracking-tighter uppercase">
                SecretKey <span class="text-[#D4AF37]">NY-SW-BR</span>
            </h1>
            
            <div class="mt-6 max-w-md mx-auto flex flex-col items-center space-y-3">
                <input type="text" id="userName" placeholder="NOME" 
                    class="w-full bg-white border-2 border-gray-100 p-4 rounded-2xl text-center font-mono outline-none uppercase shadow-sm">
                
                <input type="tel" id="userWhatsApp" placeholder="WHATSAPP (EX: 5511999999999)" 
                    oninput="checkInputs()"
                    class="w-full bg-white border-2 border-gray-100 p-4 rounded-2xl text-center font-mono outline-none shadow-sm">
                
                <button id="btn-name" onclick="confirmIdentity()" class="enter-btn">GERAR IDENTIDADE</button>
                <p class="text-[10px] text-blue-600 font-bold tracking-widest" id="nameStatus">AGUARDANDO START...</p>
            </div>
        </div>

        <div class="grid md:grid-cols-3 gap-8">
            <div id="node-ny" class="node-card">
                <div class="card-inner">
                    <span class="text-[9px] font-bold tracking-[0.3em] text-blue-500 mb-6 uppercase">Node NY</span>
                    <input type="password" id="passNY" placeholder="SENHA NY" oninput="checkPass('ny')"
                        class="w-full bg-gray-50 border p-4 rounded-xl text-center font-mono text-sm outline-none">
                    <button id="btn-ny" onclick="confirmNY()" class="enter-btn">ENTER NY</button>
                </div>
            </div>

            <div id="node-sw" class="node-card">
                <div class="card-inner">
                    <span class="text-[9px] font-bold tracking-[0.3em] text-yellow-600 mb-6 uppercase">Node SW</span>
                    <input type="password" id="passSW" placeholder="VALOR RECEBIDO" oninput="checkPass('sw')"
                        class="w-full bg-gray-50 border p-4 rounded-xl text-center font-mono text-sm outline-none">
                    <button id="btn-sw" onclick="confirmSW()" class="enter-btn">ENTER SW</button>
                </div>
            </div>

            <div id="node-br" class="node-card">
                <div class="card-inner">
                    <span class="text-[9px] font-bold tracking-[0.3em] text-green-600 mb-6 uppercase">Node BR</span>
                    <input type="text" id="passBR" readonly placeholder="AGUARDANDO..." 
                        class="w-full bg-green-50 border border-green-200 p-4 rounded-xl text-center font-mono text-xs text-green-700 font-bold mb-4">
                    <button id="btn-copy" onclick="copyKey()" class="hidden text-[10px] font-bold text-green-700 flex items-center gap-2 bg-green-100 px-4 py-2 rounded-full hover:bg-green-200">
                        COPIAR KEY
                    </button>
                </div>
            </div>

            <div class="md:col-span-3 text-center mt-6">
                <button id="finalBtn" onclick="deploySystem()" class="gold-button px-20 py-5 rounded-2xl text-[10px] font-black uppercase tracking-[0.5em] transition-all shadow-xl">
                    DEPLOY SECRET-KEY PROTOCOL
                </button>
            </div>
        </div>
    </div>
<script>
    let nameSum = 0;

    // NOVO: Recupera√ß√£o autom√°tica dos dados da P√°gina 112 ao carregar
    window.onload = function() {
        const savedName = localStorage.getItem('userName');
        if (savedName) {
            // Preenche o campo de nome automaticamente
            const nameInput = document.getElementById('userName');
            nameInput.value = savedName.toUpperCase();
            
            // Dispara a verifica√ß√£o visual para liberar o bot√£o de WhatsApp
            checkInputs();
            
            console.log("Dados transportados da 112: " + savedName);
        }
    };

    // Loader de processamento IArtium (Original mantido)
    function runIArtium(callback) {
        document.getElementById('loader').style.display = 'block';
        let bar = document.getElementById('loader-bar');
        bar.style.width = "0%";
        setTimeout(() => bar.style.width = "100%", 100);
        setTimeout(() => {
            document.getElementById('loader').style.display = 'none';
            callback();
        }, 800);
    }

    // Monitora preenchimento de Nome e WhatsApp (Original mantido)
    function checkInputs() {
        const name = document.getElementById('userName').value;
        const wa = document.getElementById('userWhatsApp').value;
        const waClean = wa.replace(/\D/g, ''); 
        const isReady = name.length >= 2 && waClean.length >= 10;
        document.getElementById('btn-name').classList.toggle('btn-show', isReady);
    }

    // ETAPA 01: Confirma Identidade e gera a soma num√©rica
    function confirmIdentity() {
        runIArtium(() => {
            const nameRaw = document.getElementById('userName').value;
            const wa = document.getElementById('userWhatsApp').value;
            const name = nameRaw.toLowerCase();
            
            // C√°lculo da Identidade Num√©rica (Original mantido)
            nameSum = 0;
            for (let i = 0; i < name.length; i++) {
                let code = name.charCodeAt(i) - 96;
                if (code > 0 && code <= 26) nameSum += code;
            }
            
            // Mensagem para WhatsApp (Original mantida)
            const saudacao = `Ol√°, ${nameRaw}! √â um prazer receb√™-lo na Holding Paulo Salom√£o. üèõÔ∏è%0A%0APara garantir a cust√≥dia soberana de seus ativos, o protocolo SecretKey gerou sua Identidade Num√©rica √∫nica:%0A%0Aüîë C√ìDIGO DE ACESSO (N√≥ Su√≠√ßa): *${nameSum}*%0A%0APor favor, insira este valor no terminal para sincronizar suas chaves globais. Sua seguran√ßa √© nossa prioridade absoluta. üõ°Ô∏è`;
            
            window.open(`https://api.whatsapp.com/send?phone=${wa}&text=${saudacao}`, '_blank');

            document.getElementById('nameStatus').innerHTML = "<span class='text-green-600 font-bold'>‚óè MENSAGEM DE BOAS-VINDAS ENVIADA</span>";
            document.getElementById('node-ny').classList.add('node-active');
            document.getElementById('btn-name').style.display = 'none';
            document.getElementById('passSW').type = "password";
        });
    }

    // ETAPA 02 e 03 (Originais mantidas)
    function checkPass(node) {
        const val = document.getElementById('pass' + node.toUpperCase()).value;
        document.getElementById('btn-' + node).classList.toggle('btn-show', val.length > 0);
    }

    function confirmNY() {
        runIArtium(() => {
            document.getElementById('node-ny').classList.add('completed');
            document.getElementById('node-sw').classList.add('node-active');
            document.getElementById('btn-ny').style.display = 'none';
        });
    }

    function confirmSW() {
        const val = parseInt(document.getElementById('passSW').value);
        if(val === nameSum) {
            runIArtium(() => {
                document.getElementById('node-sw').classList.add('completed');
                document.getElementById('node-br').classList.add('node-active');
                
                // Gera a Key Final e SALVA para usar na 114/116
                const keyFinal = "HPS-" + nameSum + "-" + Math.floor(Math.random()*999) + "-SNC";
                document.getElementById('passBR').value = keyFinal;
                localStorage.setItem('finalKey', keyFinal); // SALVANDO A CHAVE
                
                document.getElementById('node-br').classList.add('completed');
                document.getElementById('btn-copy').classList.remove('hidden');
                document.getElementById('finalBtn').classList.add('btn-ready');
                document.getElementById('btn-sw').style.display = 'none';
            });
        } else { 
            alert("Erro de Sincronia: O valor inserido n√£o corresponde √† sua Identidade Num√©rica."); 
        }
    }

    // Finaliza√ß√£o e Redirecionamento (Original atualizado)
    function deploySystem() {
        alert("PROTOCOLO FINALIZADO: Handshake estabelecido com Node Global. Redirecionando para Terminal de Governan√ßa...");
        window.location.href = "secretlogin114.html"; 
    }
    
    // Fun√ß√£o copiar (Original mantida)
    function copyKey() {
        const copyText = document.getElementById("passBR");
        copyText.select();
        navigator.clipboard.writeText(copyText.value);
        const btn = document.getElementById('btn-copy');
        btn.innerHTML = "KEY COPIADA!";
        btn.classList.add('bg-green-600', 'text-white');
    }
</script>
</body>
</html>
